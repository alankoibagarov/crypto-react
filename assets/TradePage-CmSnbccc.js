import{j as e,u as I,a as D,r as a,e as B,f as S,g as G,R as H,c as b,C as h,h as j,L as O,B as k,i as M}from"./index-B7vbRM55.js";import{u as E,a as $,b as q}from"./assetStore-DbIx7awk.js";const P="_wrapper_ur0p1_1",V={wrapper:P},Y="_transferContainer_1buf9_1",K="_conversionSection_1buf9_25",Q="_inputGroup_1buf9_37",W="_input_1buf9_37",X="_swapButtonContainer_1buf9_139",J="_swapButton_1buf9_139",Z="_disabled_1buf9_215",z="_conversionRate_1buf9_231",ee="_errorHeader_1buf9_243",se="_loadingContainer_1buf9_251",t={transferContainer:Y,conversionSection:K,inputGroup:Q,input:W,swapButtonContainer:X,swapButton:J,disabled:Z,conversionRate:z,errorHeader:ee,loadingContainer:se},te=({size:n=36,color:r="currentColor"})=>e.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:"rotate(-45deg)"},children:[e.jsx("polyline",{points:"16 3 21 3 21 8"}),e.jsx("line",{x1:"4",y1:"20",x2:"21",y2:"3"}),e.jsx("polyline",{points:"8 21 3 21 3 16"})]}),ne=()=>{const n=I(s=>s.user),r=E(s=>s.fullAssetList),R=E(s=>s.setFullAssetList),y=D(),[c,x]=a.useState(B),[o,N]=a.useState(!1),[i,T]=a.useState(S),[l,m]=a.useState(""),[d,_]=a.useState(G),C=r.map((s,u)=>e.jsxs("option",{value:s.id,children:[s.name," (",s.symbol.toUpperCase(),")"]},`${s.id}-${u}`)),{data:F,isSuccess:g,isFetching:p,isError:f,refetch:w}=$({queryKey:["fullCoinList"],queryFn:q}),L=()=>{N(!o)},A=async()=>{d>0||(await w(),v(),_(M))},v=()=>{f&&y.error("Error while fetching data")};return a.useEffect(()=>{if(d===0)return;const s=setInterval(()=>{_(u=>u-1)},H);return()=>clearInterval(s)},[d]),a.useEffect(()=>{g&&R([...r,...F])},[g]),a.useEffect(()=>{v()},[f]),a.useEffect(()=>{Number(c)<0&&x(0)},[c]),a.useEffect(()=>{r.length>0&&(l||m(r[0].id));const s=r.find(U=>U.id===l),u=(s==null?void 0:s.current_price)??S;T(u)},[r,l]),p?e.jsx(ae,{}):f?e.jsx(re,{onRefetch:()=>A(),timeout:d}):e.jsxs("div",{className:t.transferContainer,children:[e.jsx("h2",{children:"Crypto Converter"}),e.jsxs("div",{className:t.conversionSection,children:[e.jsx("label",{htmlFor:"fromAmount",children:o?"USD":"Cryptocurrency"}),e.jsxs("div",{className:t.inputGroup,children:[e.jsx("input",{id:"fromAmount",type:"number",className:b(t.input),value:c,onChange:s=>x(Number(s.target.value)),placeholder:"Enter amount",step:"any",disabled:p||!n}),o?e.jsxs("div",{className:t.conversionRate,children:["Conversion rate:"," ",o?(1/i).toLocaleString("en-US",{maximumFractionDigits:h}):i.toLocaleString("en-US",{maximumFractionDigits:h})]}):e.jsxs("select",{id:"fromCurrency",value:l,onChange:s=>m(s.target.value),disabled:!r.length||p||!n,children:[e.jsx("option",{value:"",children:"Select"}),C]})]})]}),e.jsx("div",{className:t.swapButtonContainer,children:e.jsx("button",{disabled:!n,className:t.swapButton,onClick:L,title:"Swap",children:e.jsx(te,{})})}),e.jsxs("div",{className:t.conversionSection,children:[e.jsx("label",{htmlFor:"toCurrency",children:o?"Cryptocurrency":"USD"}),e.jsxs("div",{className:t.inputGroup,children:[e.jsx("div",{className:t.conversionRate,children:o?((c??1)*(1/i)).toLocaleString("en-US",{maximumFractionDigits:j}):((c??1)*i).toLocaleString("en-US",{maximumFractionDigits:j})}),o?e.jsxs("select",{id:"fromCurrency",value:l,onChange:s=>m(s.target.value),disabled:!r.length||p||!n,children:[e.jsx("option",{value:"",children:"Select"}),C]}):e.jsxs("div",{className:t.conversionRate,children:["Conversion rate:"," ",o?(1/i).toLocaleString("en-US",{maximumFractionDigits:h}):i.toLocaleString("en-US",{maximumFractionDigits:h})]})]})]}),!n&&e.jsx("p",{className:t.disabled,children:"Functionality is disabled. Please, Login to use it"})]})},re=({timeout:n,onRefetch:r})=>e.jsxs("div",{className:t.transferContainer,children:[e.jsx("h2",{className:t.errorHeader,children:"Error occured, while fetching data. You can try to reload by pushing the button below."}),e.jsx(k,{disabled:!!n,onClick:()=>r(),children:"Reload"}),n?e.jsxs("span",{children:["You can try again in ",n," seconds"]}):""]}),ae=()=>e.jsxs("div",{className:b(t.transferContainer,t.loadingContainer),children:[e.jsx("h2",{children:"Loading"}),e.jsx(O,{})]}),ce=()=>e.jsx("div",{className:V.wrapper,children:e.jsx(ne,{})});export{ce as default};
