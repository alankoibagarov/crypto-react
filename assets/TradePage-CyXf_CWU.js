import{j as e,u as I,a as B,r as a,R as U,c as b,C as h,d as j,L as D,B as G,e as k}from"./index-C-xfU-_E.js";import{u as S,a as H,b as O}from"./assetStore-Dgsmwmd9.js";const $="_wrapper_ur0p1_1",q={wrapper:$},P="_transferContainer_1buf9_1",V="_conversionSection_1buf9_25",Y="_inputGroup_1buf9_37",K="_input_1buf9_37",M="_swapButtonContainer_1buf9_139",Q="_swapButton_1buf9_139",W="_disabled_1buf9_215",J="_conversionRate_1buf9_231",X="_errorHeader_1buf9_243",Z="_loadingContainer_1buf9_251",s={transferContainer:P,conversionSection:V,inputGroup:Y,input:K,swapButtonContainer:M,swapButton:Q,disabled:W,conversionRate:J,errorHeader:X,loadingContainer:Z},z=({size:n=36,color:r="currentColor"})=>e.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transform:"rotate(-45deg)"},children:[e.jsx("polyline",{points:"16 3 21 3 21 8"}),e.jsx("line",{x1:"4",y1:"20",x2:"21",y2:"3"}),e.jsx("polyline",{points:"8 21 3 21 3 16"})]}),ee=()=>{const n=I(t=>t.user),r=S(t=>t.fullAssetList),y=S(t=>t.setFullAssetList),w=B(),[c,x]=a.useState(1),[o,N]=a.useState(!1),[i,E]=a.useState(0),[l,m]=a.useState(""),[d,C]=a.useState(0),g=r.map((t,u)=>e.jsxs("option",{value:t.id,children:[t.name," (",t.symbol.toUpperCase(),")"]},`${t.id}-${u}`)),{data:R,isSuccess:v,isFetching:p,isError:f,refetch:L}=H({queryKey:["fullCoinList"],queryFn:O}),F=()=>{N(!o)},T=async()=>{d>0||(await L(),_(),C(k))},_=()=>{f&&w.error("Error while fetching data")};return a.useEffect(()=>{if(d===0)return;const t=setInterval(()=>{C(u=>u-1)},U);return()=>clearInterval(t)},[d]),a.useEffect(()=>{v&&y([...r,...R])},[v]),a.useEffect(()=>{_()},[f]),a.useEffect(()=>{Number(c)<0&&x(0)},[c]),a.useEffect(()=>{r.length>0&&(l||m(r[0].id));const t=r.find(A=>A.id===l),u=(t==null?void 0:t.current_price)??0;E(u)},[r,l]),p?e.jsx(se,{}):f?e.jsx(te,{onRefetch:()=>T(),timeout:d}):e.jsxs("div",{className:s.transferContainer,children:[e.jsx("h2",{children:"Crypto Converter"}),e.jsxs("div",{className:s.conversionSection,children:[e.jsx("label",{htmlFor:"fromAmount",children:o?"USD":"Cryptocurrency"}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("input",{id:"fromAmount",type:"number",className:b(s.input),value:c,onChange:t=>x(Number(t.target.value)),placeholder:"Enter amount",step:"any",disabled:p||!n}),o?e.jsxs("div",{className:s.conversionRate,children:["Conversion rate:"," ",o?(1/i).toLocaleString("en-US",{maximumFractionDigits:h}):i.toLocaleString("en-US",{maximumFractionDigits:h})]}):e.jsxs("select",{id:"fromCurrency",value:l,onChange:t=>m(t.target.value),disabled:!r.length||p||!n,children:[e.jsx("option",{value:"",children:"Select"}),g]})]})]}),e.jsx("div",{className:s.swapButtonContainer,children:e.jsx("button",{disabled:!n,className:s.swapButton,onClick:F,title:"Swap",children:e.jsx(z,{})})}),e.jsxs("div",{className:s.conversionSection,children:[e.jsx("label",{htmlFor:"toCurrency",children:o?"Cryptocurrency":"USD"}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("div",{className:s.conversionRate,children:o?((c??1)*(1/i)).toLocaleString("en-US",{maximumFractionDigits:j}):((c??1)*i).toLocaleString("en-US",{maximumFractionDigits:j})}),o?e.jsxs("select",{id:"fromCurrency",value:l,onChange:t=>m(t.target.value),disabled:!r.length||p||!n,children:[e.jsx("option",{value:"",children:"Select"}),g]}):e.jsxs("div",{className:s.conversionRate,children:["Conversion rate:"," ",o?(1/i).toLocaleString("en-US",{maximumFractionDigits:h}):i.toLocaleString("en-US",{maximumFractionDigits:h})]})]})]}),!n&&e.jsx("p",{className:s.disabled,children:"Functionality is disabled. Please, Login to use it"})]})},te=({timeout:n,onRefetch:r})=>e.jsxs("div",{className:s.transferContainer,children:[e.jsx("h2",{className:s.errorHeader,children:"Error occured, while fetching data. You can try to reload by pushing the button below."}),e.jsx(G,{disabled:!!n,onClick:()=>r(),children:"Reload"}),n?e.jsxs("span",{children:["You can try again in ",n," seconds"]}):""]}),se=()=>e.jsxs("div",{className:b(s.transferContainer,s.loadingContainer),children:[e.jsx("h2",{children:"Loading"}),e.jsx(D,{})]}),ae=()=>e.jsx("div",{className:q.wrapper,children:e.jsx(ee,{})});export{ae as default};
