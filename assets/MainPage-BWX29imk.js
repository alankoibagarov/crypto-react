import{r as u,j as t,c as N,B as b,u as A,a as q,b as D,L as I}from"./index-C-xfU-_E.js";import{u as x,a as M,f as T}from"./assetStore-Dgsmwmd9.js";const U="_table_1eqg0_1",z="_th_1eqg0_19",F="_td_1eqg0_37",O="_sortImg_1eqg0_87",R="_sortable_1eqg0_99",f={table:U,th:z,td:F,sortImg:O,sortable:R},P="/crypto-react/assets/sort-up-qDu4ShZw.png",Y="/crypto-react/assets/sort-down-BxsEOI9i.png";var d=(e=>(e.ASC="ASC",e.DESC="DESC",e))(d||{}),S=(e=>(e.BUY="BUY",e.SELL="SELL",e))(S||{});const $=(e,o,n)=>{if(e==null&&o==null)return 0;if(e==null)return 1;if(o==null)return-1;if(typeof e=="boolean"&&(e=Number(e)),typeof o=="boolean"&&(o=Number(o)),typeof e=="string"&&typeof o=="string"){const c=e.localeCompare(o,void 0,{sensitivity:"base"});return n===d.ASC?c:-c}return e>o?n===d.ASC?1:-1:e<o?n===d.ASC?-1:1:0},H=({columns:e=[],rows:o=[]})=>{const[n,c]=u.useState(""),[a,l]=u.useState(d.ASC),m=[...o].sort((s,i)=>$(s[n],i[n],a)),h=s=>{if(s.sortable){if(s.key===n){l(a===d.ASC?d.DESC:d.ASC);return}c(s.key)}};return t.jsxs("table",{className:f.table,children:[t.jsx("colgroup",{children:e.map(s=>t.jsx("col",{style:{width:s.width}}))}),t.jsx("thead",{children:t.jsx("tr",{children:e.map((s,i)=>t.jsxs("th",{className:N(f.th,s.sortable&&f.sortable),style:{width:s.width},onClick:()=>h(s),children:[s.name,s.sortable&&s.key===n&&t.jsx("img",{className:f.sortImg,src:a===d.ASC?P:Y,alt:"Sort"})]},i))})}),t.jsx("tbody",{children:m.map((s,i)=>t.jsx("tr",{children:e.map((p,_)=>t.jsx("td",{className:f.td,style:{width:p.width},children:p.renderCell?p.renderCell(s==null?void 0:s[p.key],s,i,_):s[p.key]},_))},i))})]})},K="_wrapper_zwalv_1",Q="_title_zwalv_39",V="_actions_zwalv_55",Z="_icon_zwalv_65",G="_showMoreBlock_zwalv_75",g={wrapper:K,title:Q,actions:V,icon:Z,showMoreBlock:G},J="_dropdown_qfgs8_1",W="_dropdownContent_qfgs8_11",X="_dropdownButton_qfgs8_43",y={dropdown:J,dropdownContent:W,dropdownButton:X},ee=({disabled:e=!1,onBuy:o,onSell:n})=>{const[c,a]=u.useState(!1),l=u.useRef(null),m=()=>a(!c);return u.useEffect(()=>{const h=s=>{l.current&&!l.current.contains(s.target)&&a(!1)};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[]),t.jsxs("div",{className:y.dropdown,ref:l,children:[t.jsx(b,{variant:"secondary",disabled:e,onClick:m,className:y.dropdownToggle,children:"Actions"}),c&&t.jsxs("div",{className:y.dropdownContent,children:[t.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{o(),a(!1)},children:"Buy"}),t.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{n(),a(!1)},children:"Sell"})]})]})},re=()=>{const e=A(r=>r.user),o=q(),[n,c]=u.useState(1),a=x(r=>r.setLoading),l=x(r=>r.assetList),m=x(r=>r.setAssetList),{setModalOpen:h}=D(),{data:s,isSuccess:i,refetch:p,isFetching:_,isError:C}=M({queryKey:["cryptoCoins"],queryFn:()=>T(n)}),v=[{name:"Icon",key:"image",width:80,renderCell:(r,w)=>t.jsx("img",{className:g.icon,src:String(w.image),alt:"Icon"})},{name:"Name",key:"name",sortable:!0},{name:"Price (USD)",key:"current_price",renderCell:(r,w)=>{var B;return(B=w.current_price)==null?void 0:B.toLocaleString("en-US",{maximumFractionDigits:3})},sortable:!0},{name:"",key:"actions",width:100,renderCell:()=>t.jsx(t.Fragment,{children:t.jsx("div",{title:e?"":"Please log in",className:g.actions,children:t.jsx(ee,{disabled:_,onBuy:()=>j(S.BUY),onSell:()=>j(S.SELL)})})})}],L=l?l.map(r=>({id:r.id,name:r.name,symbol:r.symbol,current_price:r.current_price,market_cap:r.market_cap,image:r.image})):[],E=async()=>{a(!0),await c(n+1),await p(),k(),a(!1)},j=r=>{if(!e){h(!0);return}const w=r===S.BUY?"Buy":"Sell";o.success(`${w} button is clicked`)},k=()=>{C&&o.error("Error while fetching data")};return u.useEffect(()=>{i&&m([...l,...s])},[i,s,m]),u.useEffect(()=>{k()},[C]),t.jsxs("div",{className:g.wrapper,children:[t.jsx("h1",{className:g.title,children:"Home"}),t.jsx(H,{columns:v,rows:L}),t.jsx("div",{className:g.showMoreBlock,children:_?t.jsx(I,{}):t.jsx(b,{onClick:E,children:"Show more"})})]})};export{re as default};
