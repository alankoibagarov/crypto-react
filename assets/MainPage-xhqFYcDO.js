import{r as u,j as s,c as N,B as E,u as v,a as I,D as T,b as D,T as q,d as M,L as U,P as O}from"./index-D2ZM1aS-.js";import{u as C,a as F,f as P}from"./assetStore-DIqCV6Px.js";const R="_table_1eqg0_1",z="_th_1eqg0_19",Y="_td_1eqg0_37",H="_sortImg_1eqg0_87",$="_sortable_1eqg0_99",f={table:R,th:z,td:Y,sortImg:H,sortable:$},G="/crypto-react/assets/sort-up-qDu4ShZw.png",W="/crypto-react/assets/sort-down-BxsEOI9i.png";var d=(e=>(e.ASC="ASC",e.DESC="DESC",e))(d||{}),S=(e=>(e.BUY="BUY",e.SELL="SELL",e))(S||{});const K=(e,o,n)=>{if(e==null&&o==null)return 0;if(e==null)return 1;if(o==null)return-1;if(typeof e=="boolean"&&(e=Number(e)),typeof o=="boolean"&&(o=Number(o)),typeof e=="string"&&typeof o=="string"){const c=e.localeCompare(o,void 0,{sensitivity:"base"});return n===d.ASC?c:-c}return e>o?n===d.ASC?1:-1:e<o?n===d.ASC?-1:1:0},Q=({columns:e=[],rows:o=[]})=>{const[n,c]=u.useState(""),[a,l]=u.useState(d.ASC),_=[...o].sort((t,i)=>K(t[n],i[n],a)),m=t=>{if(t.sortable){if(t.key===n){l(a===d.ASC?d.DESC:d.ASC);return}c(t.key)}};return s.jsxs("table",{className:f.table,children:[s.jsx("colgroup",{children:e.map(t=>s.jsx("col",{style:{width:t.width}},t.key))}),s.jsx("thead",{children:s.jsx("tr",{children:e.map((t,i)=>s.jsxs("th",{className:N(f.th,t.sortable&&f.sortable),style:{width:t.width},onClick:()=>m(t),children:[t.name,t.sortable&&t.key===n&&s.jsx("img",{className:f.sortImg,src:a===d.ASC?G:W,alt:"Sort"})]},i))})}),s.jsx("tbody",{children:_.map((t,i)=>s.jsx("tr",{children:e.map((p,h)=>s.jsx("td",{className:f.td,style:{width:p.width},children:p.renderCell?p.renderCell(t==null?void 0:t[p.key],t,i,h):t[p.key]},h))},i))})]})},V="_wrapper_zwalv_1",X="_title_zwalv_39",Z="_actions_zwalv_55",J="_icon_zwalv_65",ee="_showMoreBlock_zwalv_75",g={wrapper:V,title:X,actions:Z,icon:J,showMoreBlock:ee},te="_dropdown_qfgs8_1",se="_dropdownContent_qfgs8_11",re="_dropdownButton_qfgs8_43",y={dropdown:te,dropdownContent:se,dropdownButton:re},oe=({disabled:e=!1,onBuy:o,onSell:n})=>{const[c,a]=u.useState(!1),l=u.useRef(null),_=()=>a(!c);return u.useEffect(()=>{const m=t=>{l.current&&!l.current.contains(t.target)&&a(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]),s.jsxs("div",{className:y.dropdown,ref:l,children:[s.jsx(E,{variant:"secondary",disabled:e,onClick:_,className:y.dropdownToggle,children:"Actions"}),c&&s.jsxs("div",{className:y.dropdownContent,children:[s.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{o(),a(!1)},children:"Buy"}),s.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{n(),a(!1)},children:"Sell"})]})]})},ce=()=>{const e=v(r=>r.user),o=I(),[n,c]=u.useState(T),a=C(r=>r.setLoading),l=C(r=>r.assetList),_=C(r=>r.setAssetList),{setModalOpen:m}=D(),{data:t,isSuccess:i,refetch:p,isFetching:h,isError:x}=F({queryKey:["cryptoCoins"],queryFn:()=>P(n)}),b=[{name:"Icon",key:"image",width:q,renderCell:(r,w)=>s.jsx("img",{className:g.icon,src:String(w.image),alt:"Icon"})},{name:"Name",key:"name",sortable:!0},{name:"Price (USD)",key:"current_price",renderCell:(r,w)=>{var k;return(k=w.current_price)==null?void 0:k.toLocaleString("en-US",{maximumFractionDigits:O})},sortable:!0},{name:"",key:"actions",width:M,renderCell:()=>s.jsx(s.Fragment,{children:s.jsx("div",{title:e?"":"Please log in",className:g.actions,children:s.jsx(oe,{disabled:h,onBuy:()=>j(S.BUY),onSell:()=>j(S.SELL)})})})}],L=l?l.map(r=>({id:r.id,name:r.name,symbol:r.symbol,current_price:r.current_price,market_cap:r.market_cap,image:r.image})):[],A=async()=>{a(!0),await c(n+1),await p(),B(),a(!1)},j=r=>{if(!e){m(!0);return}const w=r===S.BUY?"Buy":"Sell";o.success(`${w} button is clicked`)},B=()=>{x&&o.error("Error while fetching data")};return u.useEffect(()=>{i&&_([...l,...t])},[i,t,_]),u.useEffect(()=>{B()},[x]),s.jsxs("div",{className:g.wrapper,children:[s.jsx("h1",{className:g.title,children:"Home"}),s.jsx(Q,{columns:b,rows:L}),s.jsx("div",{className:g.showMoreBlock,children:h?s.jsx(U,{}):s.jsx(E,{onClick:A,children:"Show more"})})]})};export{ce as default};
