import{r as u,j as t,c as N,B as E,u as v,a as I,D as T,b as D,T as q,d as M,L as U,P as O}from"./index-B7vbRM55.js";import{u as C,a as F,f as P}from"./assetStore-DbIx7awk.js";const R="_table_1eqg0_1",z="_th_1eqg0_19",Y="_td_1eqg0_37",H="_sortImg_1eqg0_87",$="_sortable_1eqg0_99",f={table:R,th:z,td:Y,sortImg:H,sortable:$},G="/crypto-react/assets/sort-up-qDu4ShZw.png",W="/crypto-react/assets/sort-down-BxsEOI9i.png";var d=(e=>(e.ASC="ASC",e.DESC="DESC",e))(d||{}),S=(e=>(e.BUY="BUY",e.SELL="SELL",e))(S||{});const K=(e,o,n)=>{if(e==null&&o==null)return 0;if(e==null)return 1;if(o==null)return-1;if(typeof e=="boolean"&&(e=Number(e)),typeof o=="boolean"&&(o=Number(o)),typeof e=="string"&&typeof o=="string"){const c=e.localeCompare(o,void 0,{sensitivity:"base"});return n===d.ASC?c:-c}return e>o?n===d.ASC?1:-1:e<o?n===d.ASC?-1:1:0},Q=({columns:e=[],rows:o=[]})=>{const[n,c]=u.useState(""),[a,l]=u.useState(d.ASC),_=[...o].sort((s,i)=>K(s[n],i[n],a)),m=s=>{if(s.sortable){if(s.key===n){l(a===d.ASC?d.DESC:d.ASC);return}c(s.key)}};return t.jsxs("table",{className:f.table,children:[t.jsx("colgroup",{children:e.map(s=>t.jsx("col",{style:{width:s.width}}))}),t.jsx("thead",{children:t.jsx("tr",{children:e.map((s,i)=>t.jsxs("th",{className:N(f.th,s.sortable&&f.sortable),style:{width:s.width},onClick:()=>m(s),children:[s.name,s.sortable&&s.key===n&&t.jsx("img",{className:f.sortImg,src:a===d.ASC?G:W,alt:"Sort"})]},i))})}),t.jsx("tbody",{children:_.map((s,i)=>t.jsx("tr",{children:e.map((p,h)=>t.jsx("td",{className:f.td,style:{width:p.width},children:p.renderCell?p.renderCell(s==null?void 0:s[p.key],s,i,h):s[p.key]},h))},i))})]})},V="_wrapper_zwalv_1",X="_title_zwalv_39",Z="_actions_zwalv_55",J="_icon_zwalv_65",ee="_showMoreBlock_zwalv_75",g={wrapper:V,title:X,actions:Z,icon:J,showMoreBlock:ee},te="_dropdown_qfgs8_1",se="_dropdownContent_qfgs8_11",re="_dropdownButton_qfgs8_43",y={dropdown:te,dropdownContent:se,dropdownButton:re},oe=({disabled:e=!1,onBuy:o,onSell:n})=>{const[c,a]=u.useState(!1),l=u.useRef(null),_=()=>a(!c);return u.useEffect(()=>{const m=s=>{l.current&&!l.current.contains(s.target)&&a(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]),t.jsxs("div",{className:y.dropdown,ref:l,children:[t.jsx(E,{variant:"secondary",disabled:e,onClick:_,className:y.dropdownToggle,children:"Actions"}),c&&t.jsxs("div",{className:y.dropdownContent,children:[t.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{o(),a(!1)},children:"Buy"}),t.jsx("button",{disabled:e,className:y.dropdownButton,onClick:()=>{n(),a(!1)},children:"Sell"})]})]})},ce=()=>{const e=v(r=>r.user),o=I(),[n,c]=u.useState(T),a=C(r=>r.setLoading),l=C(r=>r.assetList),_=C(r=>r.setAssetList),{setModalOpen:m}=D(),{data:s,isSuccess:i,refetch:p,isFetching:h,isError:x}=F({queryKey:["cryptoCoins"],queryFn:()=>P(n)}),b=[{name:"Icon",key:"image",width:q,renderCell:(r,w)=>t.jsx("img",{className:g.icon,src:String(w.image),alt:"Icon"})},{name:"Name",key:"name",sortable:!0},{name:"Price (USD)",key:"current_price",renderCell:(r,w)=>{var k;return(k=w.current_price)==null?void 0:k.toLocaleString("en-US",{maximumFractionDigits:O})},sortable:!0},{name:"",key:"actions",width:M,renderCell:()=>t.jsx(t.Fragment,{children:t.jsx("div",{title:e?"":"Please log in",className:g.actions,children:t.jsx(oe,{disabled:h,onBuy:()=>j(S.BUY),onSell:()=>j(S.SELL)})})})}],L=l?l.map(r=>({id:r.id,name:r.name,symbol:r.symbol,current_price:r.current_price,market_cap:r.market_cap,image:r.image})):[],A=async()=>{a(!0),await c(n+1),await p(),B(),a(!1)},j=r=>{if(!e){m(!0);return}const w=r===S.BUY?"Buy":"Sell";o.success(`${w} button is clicked`)},B=()=>{x&&o.error("Error while fetching data")};return u.useEffect(()=>{i&&_([...l,...s])},[i,s,_]),u.useEffect(()=>{B()},[x]),t.jsxs("div",{className:g.wrapper,children:[t.jsx("h1",{className:g.title,children:"Home"}),t.jsx(Q,{columns:b,rows:L}),t.jsx("div",{className:g.showMoreBlock,children:h?t.jsx(U,{}):t.jsx(E,{onClick:A,children:"Show more"})})]})};export{ce as default};
